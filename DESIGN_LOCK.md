# DESIGN LOCK (Jeomshin 기준) - 사주 계산 코어 잠금 문서

이 문서는 사주박사 API의 "사주 계산 코어"가 시중 만세력/점신 기준으로 검증 완료되었음을 고정한다.
이 문서에 적힌 규칙/값은 운영 중 임의 변경 금지다.

---

## 1) 기준 (Source of Truth)
- 기준: 점신(Jeomshin) / 시중 만세력 결과와 일치
- 목표: 연/월/일/시 간지 계산 결과가 점신과 동일해야 한다.
- 주의: 다른 만세력/학술 기준으로 변경 시 결과 불일치 민원 발생 가능.

---

## 2) 잠금 규칙 (LOCKED RULES)

### 2-1. 월주 (Month Pillar) - 절기 경계
- 규칙: 절기(Jieqi) 발생 "당일"은 이전 월 유지
- 전환: 절기 "다음날 00:00 (KST)"부터 새 월 적용
- 상태: 점신 기준 검증 완료 (1979-08 입추 테스트로 확인)

### 2-2. 연주 (Year Pillar) - 입춘 경계
- 규칙: 입춘(Ipchun) 발생 "당일"은 이전 해 유지
- 전환: 입춘 "다음날 00:00 (KST)"부터 새 해 적용
- 점신 검증:
  - 1979-02-04 10:00 -> 戊午
  - 1979-02-05 10:00 -> 己未

### 2-3. 일주 (Day Pillar) - JDN 오프셋
- 방식: Gregorian -> JDN 변환 후 60갑자 인덱스 계산
- 잠금 값: DAY_PILLAR_JDN_OFFSET = 49
- 변경 금지: 이 값 변경 시 연속 일주가 점신과 불일치

### 2-4. 시주 (Hour Pillar) - 자시 경계
- 규칙: 자시(子) 시작은 23:00
- 경계 검증(점신):
  - 22:59 -> 亥
  - 23:00 -> 子

---

## 3) 검증 케이스 파일
- 파일: data/verified_cases.json
- 의미: 점신 기준으로 검증 완료된 정답표(증거)이며, 코어 변경 시 반드시 재검증에 사용한다.

---

## 4) 변경 정책 (절대 준수)
- 계산 코어(연/월/일/시) 변경 시:
  1) 점신 스크린샷/결과로 재검증 근거 확보
  2) data/verified_cases.json 업데이트
  3) 변경 사유/영향 범위를 이 문서에 기록
- 근거 없는 추측 수정/리팩토링 금지
